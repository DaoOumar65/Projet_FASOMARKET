import React, { useEffect, useState } from 'react';\nimport { Bell, Check, X, Info, AlertTriangle, AlertCircle, CheckCircle } from 'lucide-react';\nimport { useNotificationStore } from '../store/notifications';\nimport { useAuthStore } from '../store';\nimport toast from 'react-hot-toast';\n\nexport default function TestNotifications() {\n  const { notifications, unreadCount, loading, fetchNotifications, markAsRead, fetchUnreadCount } = useNotificationStore();\n  const { user, isAuthenticated } = useAuthStore();\n  const [testNotifications, setTestNotifications] = useState([\n    {\n      id: 1,\n      titre: 'Commande confirmée',\n      message: 'Votre commande #CMD123 a été confirmée et sera traitée sous peu.',\n      type: 'SUCCESS' as const,\n      lue: false,\n      dateCreation: new Date().toISOString()\n    },\n    {\n      id: 2,\n      titre: 'Stock faible',\n      message: 'Le stock de votre produit \"Chemise Traditionnelle\" est faible (2 restants).',\n      type: 'WARNING' as const,\n      lue: false,\n      dateCreation: new Date(Date.now() - 3600000).toISOString()\n    },\n    {\n      id: 3,\n      titre: 'Nouveau message',\n      message: 'Vous avez reçu un nouveau message de la part d\\'un client.',\n      type: 'INFO' as const,\n      lue: true,\n      dateCreation: new Date(Date.now() - 7200000).toISOString()\n    },\n    {\n      id: 4,\n      titre: 'Erreur de paiement',\n      message: 'Le paiement de la commande #CMD124 a échoué. Veuillez vérifier.',\n      type: 'ERROR' as const,\n      lue: false,\n      dateCreation: new Date(Date.now() - 10800000).toISOString()\n    }\n  ]);\n\n  useEffect(() => {\n    if (isAuthenticated) {\n      fetchNotifications();\n      fetchUnreadCount();\n    }\n  }, [isAuthenticated]);\n\n  const getTypeIcon = (type: string) => {\n    switch (type) {\n      case 'SUCCESS': return <CheckCircle size={20} color=\"#10b981\" />;\n      case 'WARNING': return <AlertTriangle size={20} color=\"#f59e0b\" />;\n      case 'ERROR': return <AlertCircle size={20} color=\"#ef4444\" />;\n      default: return <Info size={20} color=\"#3b82f6\" />;\n    }\n  };\n\n  const getTypeColor = (type: string) => {\n    switch (type) {\n      case 'SUCCESS': return '#10b981';\n      case 'WARNING': return '#f59e0b';\n      case 'ERROR': return '#ef4444';\n      default: return '#3b82f6';\n    }\n  };\n\n  const simulateNotification = () => {\n    const newNotif = {\n      id: Date.now(),\n      titre: 'Test de notification',\n      message: `Notification de test créée à ${new Date().toLocaleTimeString()}`,\n      type: 'INFO' as const,\n      lue: false,\n      dateCreation: new Date().toISOString()\n    };\n    \n    setTestNotifications(prev => [newNotif, ...prev]);\n    toast.success('Notification de test créée !');\n  };\n\n  const markTestAsRead = (id: number) => {\n    setTestNotifications(prev => \n      prev.map(n => n.id === id ? { ...n, lue: true } : n)\n    );\n  };\n\n  const getUnreadTestCount = () => {\n    return testNotifications.filter(n => !n.lue).length;\n  };\n\n  if (!isAuthenticated) {\n    return (\n      <div style={{ padding: '40px', textAlign: 'center' }}>\n        <Bell size={64} style={{ color: '#9ca3af', margin: '0 auto 16px' }} />\n        <h2 style={{ fontSize: '24px', fontWeight: 'bold', color: '#111827', marginBottom: '8px' }}>\n          Test des Notifications\n        </h2>\n        <p style={{ color: '#6b7280' }}>\n          Vous devez être connecté pour tester le système de notifications.\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div style={{ maxWidth: '1200px', margin: '0 auto', padding: '20px' }}>\n      <div style={{ marginBottom: '32px' }}>\n        <h1 style={{ fontSize: '32px', fontWeight: 'bold', color: '#111827', marginBottom: '8px' }}>\n          Test du Système de Notifications\n        </h1>\n        <p style={{ color: '#6b7280', fontSize: '16px' }}>\n          Vérification du fonctionnement des notifications et de la cloche\n        </p>\n      </div>\n\n      {/* Statut utilisateur */}\n      <div style={{\n        backgroundColor: 'white',\n        borderRadius: '12px',\n        padding: '24px',\n        marginBottom: '24px',\n        border: '1px solid #e5e7eb'\n      }}>\n        <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#111827', marginBottom: '16px' }}>\n          Statut Utilisateur\n        </h2>\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '16px' }}>\n          <div>\n            <span style={{ fontSize: '14px', color: '#6b7280' }}>Utilisateur:</span>\n            <p style={{ fontSize: '16px', fontWeight: '500', color: '#111827' }}>\n              {user?.nomComplet || 'Non défini'}\n            </p>\n          </div>\n          <div>\n            <span style={{ fontSize: '14px', color: '#6b7280' }}>Rôle:</span>\n            <p style={{ fontSize: '16px', fontWeight: '500', color: '#111827' }}>\n              {user?.role || 'Non défini'}\n            </p>\n          </div>\n          <div>\n            <span style={{ fontSize: '14px', color: '#6b7280' }}>Authentifié:</span>\n            <p style={{ fontSize: '16px', fontWeight: '500', color: isAuthenticated ? '#10b981' : '#ef4444' }}>\n              {isAuthenticated ? 'Oui' : 'Non'}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* Compteurs */}\n      <div style={{\n        display: 'grid',\n        gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))',\n        gap: '20px',\n        marginBottom: '32px'\n      }}>\n        <div style={{\n          backgroundColor: 'white',\n          borderRadius: '12px',\n          padding: '24px',\n          border: '1px solid #e5e7eb',\n          textAlign: 'center'\n        }}>\n          <Bell size={32} style={{ color: '#2563eb', margin: '0 auto 12px' }} />\n          <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#111827', marginBottom: '8px' }}>\n            Notifications API\n          </h3>\n          <p style={{ fontSize: '24px', fontWeight: 'bold', color: '#2563eb' }}>\n            {loading ? '...' : unreadCount}\n          </p>\n          <p style={{ fontSize: '14px', color: '#6b7280' }}>Non lues</p>\n        </div>\n\n        <div style={{\n          backgroundColor: 'white',\n          borderRadius: '12px',\n          padding: '24px',\n          border: '1px solid #e5e7eb',\n          textAlign: 'center'\n        }}>\n          <Bell size={32} style={{ color: '#10b981', margin: '0 auto 12px' }} />\n          <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#111827', marginBottom: '8px' }}>\n            Notifications Test\n          </h3>\n          <p style={{ fontSize: '24px', fontWeight: 'bold', color: '#10b981' }}>\n            {getUnreadTestCount()}\n          </p>\n          <p style={{ fontSize: '14px', color: '#6b7280' }}>Non lues</p>\n        </div>\n      </div>\n\n      {/* Actions de test */}\n      <div style={{\n        backgroundColor: 'white',\n        borderRadius: '12px',\n        padding: '24px',\n        marginBottom: '24px',\n        border: '1px solid #e5e7eb'\n      }}>\n        <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#111827', marginBottom: '16px' }}>\n          Actions de Test\n        </h2>\n        <div style={{ display: 'flex', gap: '12px', flexWrap: 'wrap' }}>\n          <button\n            onClick={simulateNotification}\n            style={{\n              padding: '12px 24px',\n              backgroundColor: '#2563eb',\n              color: 'white',\n              border: 'none',\n              borderRadius: '8px',\n              fontSize: '14px',\n              fontWeight: '500',\n              cursor: 'pointer'\n            }}\n          >\n            Créer Notification Test\n          </button>\n          <button\n            onClick={fetchNotifications}\n            style={{\n              padding: '12px 24px',\n              backgroundColor: '#10b981',\n              color: 'white',\n              border: 'none',\n              borderRadius: '8px',\n              fontSize: '14px',\n              fontWeight: '500',\n              cursor: 'pointer'\n            }}\n          >\n            Recharger Notifications API\n          </button>\n          <button\n            onClick={fetchUnreadCount}\n            style={{\n              padding: '12px 24px',\n              backgroundColor: '#f59e0b',\n              color: 'white',\n              border: 'none',\n              borderRadius: '8px',\n              fontSize: '14px',\n              fontWeight: '500',\n              cursor: 'pointer'\n            }}\n          >\n            Actualiser Compteur\n          </button>\n        </div>\n      </div>\n\n      {/* Notifications de test */}\n      <div style={{\n        backgroundColor: 'white',\n        borderRadius: '12px',\n        padding: '24px',\n        marginBottom: '24px',\n        border: '1px solid #e5e7eb'\n      }}>\n        <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#111827', marginBottom: '16px' }}>\n          Notifications de Test ({testNotifications.length})\n        </h2>\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>\n          {testNotifications.map((notification) => (\n            <div\n              key={notification.id}\n              style={{\n                padding: '16px',\n                border: '1px solid #e5e7eb',\n                borderRadius: '8px',\n                backgroundColor: notification.lue ? '#f9fafb' : '#f8fafc',\n                borderLeft: `4px solid ${getTypeColor(notification.type)}`\n              }}\n            >\n              <div style={{ display: 'flex', alignItems: 'flex-start', gap: '12px' }}>\n                {getTypeIcon(notification.type)}\n                <div style={{ flex: 1 }}>\n                  <div style={{\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'flex-start',\n                    marginBottom: '8px'\n                  }}>\n                    <h3 style={{\n                      fontSize: '16px',\n                      fontWeight: notification.lue ? '500' : '600',\n                      color: '#111827',\n                      margin: 0\n                    }}>\n                      {notification.titre}\n                    </h3>\n                    {!notification.lue && (\n                      <button\n                        onClick={() => markTestAsRead(notification.id)}\n                        style={{\n                          padding: '4px 8px',\n                          backgroundColor: '#10b981',\n                          color: 'white',\n                          border: 'none',\n                          borderRadius: '4px',\n                          fontSize: '12px',\n                          cursor: 'pointer'\n                        }}\n                      >\n                        <Check size={12} />\n                      </button>\n                    )}\n                  </div>\n                  <p style={{\n                    color: '#6b7280',\n                    fontSize: '14px',\n                    margin: '0 0 8px 0',\n                    lineHeight: '1.4'\n                  }}>\n                    {notification.message}\n                  </p>\n                  <div style={{\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center'\n                  }}>\n                    <span style={{\n                      fontSize: '12px',\n                      color: '#9ca3af'\n                    }}>\n                      {new Date(notification.dateCreation).toLocaleString('fr-FR')}\n                    </span>\n                    <span style={{\n                      padding: '2px 8px',\n                      borderRadius: '12px',\n                      fontSize: '11px',\n                      fontWeight: '500',\n                      backgroundColor: notification.lue ? '#e5e7eb' : '#dbeafe',\n                      color: notification.lue ? '#6b7280' : '#1d4ed8'\n                    }}>\n                      {notification.lue ? 'Lue' : 'Non lue'}\n                    </span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Notifications API */}\n      {notifications.length > 0 && (\n        <div style={{\n          backgroundColor: 'white',\n          borderRadius: '12px',\n          padding: '24px',\n          border: '1px solid #e5e7eb'\n        }}>\n          <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#111827', marginBottom: '16px' }}>\n            Notifications API ({notifications.length})\n          </h2>\n          <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>\n            {notifications.map((notification) => (\n              <div\n                key={notification.id}\n                style={{\n                  padding: '16px',\n                  border: '1px solid #e5e7eb',\n                  borderRadius: '8px',\n                  backgroundColor: notification.lue ? '#f9fafb' : '#f8fafc',\n                  borderLeft: `4px solid ${getTypeColor(notification.type)}`\n                }}\n              >\n                <div style={{ display: 'flex', alignItems: 'flex-start', gap: '12px' }}>\n                  {getTypeIcon(notification.type)}\n                  <div style={{ flex: 1 }}>\n                    <div style={{\n                      display: 'flex',\n                      justifyContent: 'space-between',\n                      alignItems: 'flex-start',\n                      marginBottom: '8px'\n                    }}>\n                      <h3 style={{\n                        fontSize: '16px',\n                        fontWeight: notification.lue ? '500' : '600',\n                        color: '#111827',\n                        margin: 0\n                      }}>\n                        {notification.titre}\n                      </h3>\n                      {!notification.lue && (\n                        <button\n                          onClick={() => markAsRead(notification.id)}\n                          style={{\n                            padding: '4px 8px',\n                            backgroundColor: '#10b981',\n                            color: 'white',\n                            border: 'none',\n                            borderRadius: '4px',\n                            fontSize: '12px',\n                            cursor: 'pointer'\n                          }}\n                        >\n                          <Check size={12} />\n                        </button>\n                      )}\n                    </div>\n                    <p style={{\n                      color: '#6b7280',\n                      fontSize: '14px',\n                      margin: '0 0 8px 0',\n                      lineHeight: '1.4'\n                    }}>\n                      {notification.message}\n                    </p>\n                    <div style={{\n                      display: 'flex',\n                      justifyContent: 'space-between',\n                      alignItems: 'center'\n                    }}>\n                      <span style={{\n                        fontSize: '12px',\n                        color: '#9ca3af'\n                      }}>\n                        {new Date(notification.dateCreation).toLocaleString('fr-FR')}\n                      </span>\n                      <span style={{\n                        padding: '2px 8px',\n                        borderRadius: '12px',\n                        fontSize: '11px',\n                        fontWeight: '500',\n                        backgroundColor: notification.lue ? '#e5e7eb' : '#dbeafe',\n                        color: notification.lue ? '#6b7280' : '#1d4ed8'\n                      }}>\n                        {notification.lue ? 'Lue' : 'Non lue'}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n