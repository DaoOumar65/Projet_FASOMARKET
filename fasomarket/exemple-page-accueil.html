<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FasoMarket - Votre marketplace burkinab√®</title>
    <script src="fasoMarketAPI.js"></script>
    <style>
        .stats-container { display: flex; gap: 20px; margin: 20px 0; }
        .stat-card { background: #f5f5f5; padding: 20px; border-radius: 8px; text-align: center; }
        .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; }
        .product-card { border: 1px solid #ddd; padding: 15px; border-radius: 8px; }
        .loading { text-align: center; padding: 20px; }
    </style>
</head>
<body>
    <header>
        <h1>üèÜ FasoMarket - Plateforme N¬∞1 au Burkina Faso</h1>
        <p>Votre marketplace burkinab√®</p>
    </header>

    <main>
        <!-- Statistiques dynamiques -->
        <section id="statistiques" class="stats-container">
            <div class="loading">Chargement des statistiques...</div>
        </section>

        <!-- Produits vedettes -->
        <section>
            <h2>üåü Produits Vedettes</h2>
            <div id="produits-vedettes" class="products-grid">
                <div class="loading">Chargement des produits vedettes...</div>
            </div>
        </section>

        <!-- Nouveaux produits -->
        <section>
            <h2>üÜï Nouveaux Produits</h2>
            <div id="nouveaux-produits" class="products-grid">
                <div class="loading">Chargement des nouveaux produits...</div>
            </div>
        </section>

        <!-- Boutiques populaires -->
        <section>
            <h2>üè™ Boutiques Populaires</h2>
            <div id="boutiques-populaires" class="products-grid">
                <div class="loading">Chargement des boutiques...</div>
            </div>
        </section>

        <!-- Cat√©gories -->
        <section>
            <h2>üìÇ Cat√©gories Populaires</h2>
            <div id="categories" class="products-grid">
                <div class="loading">Chargement des cat√©gories...</div>
            </div>
        </section>
    </main>

    <script>
        // Charger toutes les donn√©es d'accueil
        async function chargerDonneesAccueil() {
            try {
                const response = await fasoMarketAPI.accueil.getDonneesCompletes();
                
                if (response.success) {
                    const data = response.data;
                    
                    // Afficher les statistiques
                    afficherStatistiques(data.statistiques);
                    
                    // Afficher les produits vedettes
                    afficherProduits(data.produits_vedettes, 'produits-vedettes');
                    
                    // Afficher les nouveaux produits
                    afficherProduits(data.nouveaux_produits, 'nouveaux-produits');
                    
                    // Afficher les boutiques populaires
                    afficherBoutiques(data.boutiques_populaires);
                    
                    // Afficher les cat√©gories
                    afficherCategories(data.categories);
                }
            } catch (error) {
                console.error('Erreur lors du chargement:', error);
            }
        }

        function afficherStatistiques(stats) {
            const container = document.getElementById('statistiques');
            container.innerHTML = `
                <div class="stat-card">
                    <h3>${stats.produits}+</h3>
                    <p>Produits</p>
                </div>
                <div class="stat-card">
                    <h3>${stats.boutiques}+</h3>
                    <p>Boutiques</p>
                </div>
                <div class="stat-card">
                    <h3>${stats.clients}+</h3>
                    <p>Clients</p>
                </div>
                <div class="stat-card">
                    <h3>${stats.vendeurs}+</h3>
                    <p>Vendeurs</p>
                </div>
            `;
        }

        function afficherProduits(produits, containerId) {
            const container = document.getElementById(containerId);
            
            if (produits.length === 0) {
                container.innerHTML = '<p>Aucun produit disponible</p>';
                return;
            }

            container.innerHTML = produits.map(produit => `
                <div class="product-card">
                    <h4>${produit.nom}</h4>
                    <p>Prix: ${produit.prix} FCFA</p>
                    <p>Boutique: ${produit.boutique.nom_boutique}</p>
                    <p>Vues: ${produit.vues || 0}</p>
                    ${produit.est_nouveau ? '<span style="color: green;">üÜï Nouveau</span>' : ''}
                    ${produit.vedette ? '<span style="color: gold;">‚≠ê Vedette</span>' : ''}
                </div>
            `).join('');
        }

        function afficherBoutiques(boutiques) {
            const container = document.getElementById('boutiques-populaires');
            
            if (boutiques.length === 0) {
                container.innerHTML = '<p>Aucune boutique disponible</p>';
                return;
            }

            container.innerHTML = boutiques.map(boutique => `
                <div class="product-card">
                    <h4>${boutique.nom_boutique}</h4>
                    <p>Vendeur: ${boutique.vendeur.user.nom} ${boutique.vendeur.user.prenom}</p>
                    <p>Produits: ${boutique.produits_count}</p>
                    <p>Note: ${boutique.note_moyenne || 'N/A'}/5</p>
                    <p>üìç ${boutique.ville}, ${boutique.pays}</p>
                </div>
            `).join('');
        }

        function afficherCategories(categories) {
            const container = document.getElementById('categories');
            
            if (categories.length === 0) {
                container.innerHTML = '<p>Aucune cat√©gorie disponible</p>';
                return;
            }

            container.innerHTML = categories.map(categorie => `
                <div class="product-card">
                    <h4>${categorie.icone || 'üì¶'} ${categorie.nom}</h4>
                    <p>${categorie.description || 'D√©couvrez nos produits'}</p>
                    <p><strong>${categorie.produits_count} produits</strong></p>
                </div>
            `).join('');
        }

        // Charger les donn√©es au chargement de la page
        document.addEventListener('DOMContentLoaded', chargerDonneesAccueil);

        // Fonctions pour les boutons d'action
        function ouvrirInscription() {
            // Rediriger vers la page d'inscription
            window.location.href = '/inscription';
        }

        function explorerProduits() {
            // Rediriger vers la page de produits
            window.location.href = '/produits';
        }

        function devenirVendeur() {
            // Rediriger vers l'inscription vendeur
            window.location.href = '/inscription-vendeur';
        }
    </script>

    <footer style="margin-top: 50px; padding: 20px; background: #f5f5f5; text-align: center;">
        <h3>Pr√™t √† commencer ?</h3>
        <p>Rejoignez des milliers d'utilisateurs qui font confiance √† FasoMarket</p>
        <button onclick="ouvrirInscription()" style="margin: 5px; padding: 10px 20px;">Cr√©er un compte</button>
        <button onclick="explorerProduits()" style="margin: 5px; padding: 10px 20px;">Explorer les produits</button>
        <button onclick="devenirVendeur()" style="margin: 5px; padding: 10px 20px;">Devenir vendeur</button>
        
        <div style="margin-top: 20px;">
            <p><strong>FasoMarket</strong> - VOTRE MARCH√â DIGITAL</p>
            <p>üìû +226 25 00 00 00 | üìß contact@fasomarket.bf | üìç Ouagadougou, Burkina Faso</p>
            <p>¬© 2024 FasoMarket. Tous droits r√©serv√©s.</p>
        </div>
    </footer>
</body>
</html>